app.controller("indexCtrl",["$scope","$http","$document","errorCode","url","fakeness","feedback","claim","lang",function(n,e,t,a,l,o,r,i,c){n.fakenessDone=!1,n.highlightedText="",n.selectedText="",n.loadingFakeness=!1,n.loadingAnalyzeUrl=!1,n.feedbackSelected=!1,n.selectedLanguage="en";var s=["true","mostly-true","half-true"];angular.element(function(){$("[rel=tooltip]").tooltip({placement:"left"}),c.getLanguages().then(function(e){n.languages=e.data,n.loading=!1})}),$("#gaugeFakeness").on("contextmenu",function(){return!1}),n.showSelectedText=function(){n.selectedText=n.getSelectionText()},n.changeLanguage=function(e){"False"!==e.active&&(n.selectedLanguage=e.language)},n.getSelectionText=function(){if(window.getSelection)try{var e=$("textarea").get(0);return n.highlightedText=e.value.substring(e.selectionStart,e.selectionEnd),n.highlightedText}catch(e){console.log("Cant get selection text")}document.selection&&"Control"!=document.selection.type&&(n.highlightedText=document.selection.createRange().text)},n.sendClaim=function(){var e={text:n.selectedText};i.getClaim(e).then(function(e){console.log(e.data),n.claims=e.data},function(e){})},n.getClaimFakeness=function(e){return s.includes(e)?"text-green":"barely-true"===e?"text-blue":"text-red"},n.clear=function(){n.selectedText="",n.claims=null},n.sendFeedback=function(e){n.feedbackSelected=!0,$("#alert").fadeIn(),$("#feedback").fadeOut();var t={title:n.title,text:n.text,label:e};r.sendFb(t).then(function(e){console.log(e)},function(e){})},n.analyzeUrl=function(){if(!n.url)return!1;n.loadingAnalyzeUrl=!0;var e=n.url;l.analyzeUrl(e).then(function(e){n.page=e.data,n.title=n.page.title,n.text=n.page.body,n.loadingAnalyzeUrl=!1},function(e){n.loadingAnalyzeUrl=!1})},n.send=function(){if(n.feedbackSelected=!1,n.fakenessDone=!1,$("#gaugeFakeness").removeClass("animated fadeIn"),zingchart.exec("gaugeFakeness","destroy"),!n.title||!n.text)return!1;var e={title:n.title,text:n.text,source:""};n.loadingFakeness=!0,o.getFakeness(e).then(function(e){n.value=e.data[0],n.fakeValue=parseInt(100*n.value.FAKE),n.realValue=parseInt(100*n.value.REAL),zingchart.render({id:"gaugeFakeness",data:{type:"gauge","background-color":"#f7fafc","scale-r":{markers:[{type:"line",range:[50],"line-color":"grey","line-width":2,"line-style":"dashed",alpha:1}],aperture:200,values:"0:100:25",center:{size:5,"background-color":"#66CCFF #FFCCFF","border-color":"none"},ring:{size:10,rules:[{rule:"%v >= 0 && %v <= 25","background-color":"green"},{rule:"%v >= 25 && %v <= 50","background-color":"yellow"},{rule:"%v >= 50 && %v <= 75","background-color":"orange"},{rule:"%v >= 75 && %v <=100","background-color":"red"}]},labels:["REAL","","","","FAKE"],item:{"font-color":"black","font-family":"Open Sans, serif","font-size":13,"font-weight":"bold","font-style":"normal","offset-r":0,angle:"auto"}},gui:{contextMenu:{empty:!0}},plot:{tooltip:{visible:!1},csize:"5%",size:"100%","background-color":"#000000"},series:[{values:[n.fakeValue]}]},height:"100%",width:"100%"}),n.fakenessDone=!0,n.loadingFakeness=!1,$("#gaugeFakeness").addClass("animated fadeIn")},function(e){n.fakenessDone=!1,n.loadingFakeness=!1,console.log(e)})}}]);