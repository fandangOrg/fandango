"use strict";app.controller("indexCtrl",["$scope","$http","$document","errorCode","crUrl","fakeness","feedback","claim","lang","alert","chart","$sce",function(e,a,t,n,l,o,s,i,d,r,c,g){e.fakenessDone=!1,e.loadingFakeness=!1,e.loadingAnalyzeUrl=!1,e.feedbackSelected=!1,e.showChart=!0,e.highlightedText="",e.selectedText="",e.fakenessColor="",e.full_response={},$(".alert").hide(),e.videoAnalysisUrl=videoAnalysisUrl,e.page={authors:[],publisher:[],url:"",text:"",title:"",date:"",lang:"",media:{images:[],video:[]}},e.media={images:[],video:[]};var u=["true","mostly-true","half-true"];angular.element(function(){e.loading=!1}),$("#gaugeFakeness").on("contextmenu",function(){return!1}),e.analyzeUrl=function(){if(!e.page.url)return!1;e.loadingAnalyzeUrl=!0,e.fakenessDone=!1,e.media={images:[],video:[]};var a=e.page.url;l.analyzeUrl(a).then(function(a){console.log(a.data),e.full_response=a.data,e.page.title=a.data.headline,e.page.text=a.data.articleBody,e.page.publisher=a.data.publisher,e.page.authors=a.data.author,e.page.date=a.data.dateCreated,e.page.lang=a.data.language,e.page.media.images=a.data.images,e.page.media.video=a.data.video,e.loadingAnalyzeUrl=!1},function(a){e.loadingAnalyzeUrl=!1})},e.showSelectedText=function(){e.selectedText=e.getSelectionText()},e.getSelectionText=function(){if(window.getSelection)try{var a=$("textarea").get(0);return e.highlightedText=a.value.substring(a.selectionStart,a.selectionEnd),e.highlightedText}catch(e){console.log("Cant get selection text")}document.selection&&"Control"!=document.selection.type&&(e.highlightedText=document.selection.createRange().text)},e.sendClaim=function(){console.log(e.selectedText);var a={text:e.selectedText};i.getClaim(a).then(function(a){console.log(a.data),e.claims=a.data},function(e){})},e.saveClaim=function(a){var t={claim:e.selectedText,label:a};i.saveClaim(t).then(function(e){r.showAlert("Success")},function(e){r.showAlert("Error")})},e.getClaimFakeness=function(e){return i.getFakeness(e,u)},e.getAuthorColor=function(e){return o.getAuthorFakeness(e)},e.clear=function(){e.selectedText="",e.claims=null},e.sendFeedback=function(a){e.feedbackSelected=!0,$("#alert").fadeIn(),$("#feedback").fadeOut();var t={title:e.page.title,text:e.page.text,label:a};s.sendFb(t).then(function(e){console.log(e)},function(e){})},e.clickCb=function(a,t,n){if(a.target.checked)e.media[t].push(n);else{var l=e.media[t].indexOf(n);-1!==l&&e.media[t].splice(l,1)}console.log(e.media)},e.getDesc=function(e){o.getInfoScore(e).then(function(a){$("#".concat(e)).prop("title",a.data),$("#".concat(e)).tooltip("show")})},e.embedVideo=function(e){return e=e.replace("watch?v=","embed/"),g.trustAsResourceUrl(e)},e.sendFakeness=function(){e.feedbackSelected=!1,e.fakenessDone=!1,$("#gaugeFakeness").removeClass("animated fadeIn"),zingchart.exec("gaugeFakeness","destroy");var a=angular.copy(e.full_response);a.images=e.media.images,a.video=e.media.video,e.loadingFakeness=!0,o.getFakeness(a).then(function(a){e.fakenessValue=a.data.text[0],e.fakeValue=parseInt(100*e.fakenessValue.FAKE),e.realValue=parseInt(100*e.fakenessValue.REAL),e.page.media.images=a.data.images,e.page.media.video=a.data.videos,e.fakenessColor=o.getFakenessColor(e.realValue),c.renderChart(e.fakeValue),e.fakenessDone=!0,e.loadingFakeness=!1,$("#gaugeFakeness").addClass("animated fadeIn"),console.log(e.full_response)},function(a){e.fakenessDone=!1,e.loadingFakeness=!1,r.showAlert("Error")})}}]);